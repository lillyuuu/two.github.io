<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”µå•†è¥é”€å²—ä½æ ‡ç­¾å¯è§†åŒ–ç³»ç»Ÿ</title>
    <!-- å¼•å…¥ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- å¼•å…¥EChartsè¯äº‘æ‰©å±• -->
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.0.0/dist/echarts-wordcloud.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f8fafc;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(800px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .chart-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 12px;
        }
        
        .chart-title i {
            margin-right: 10px;
            color: #8b5cf6;
        }
        
        .chart-wrapper {
            height: 500px;
            width: 100%;
        }
        
        .data-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }
        
        .summary-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #8b5cf6;
            margin: 10px 0;
        }
        
        .summary-label {
            font-size: 1rem;
            color: #64748b;
        }
        
        .tag-cloud-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .tag-item {
            background-color: #f1f5f9;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .tag-item:hover {
            background-color: #e0e7ff;
            transform: translateY(-2px);
        }
        
        .tag-freq-1 { font-size: 1rem; background-color: #f1f5f9; }
        .tag-freq-2 { font-size: 1.1rem; background-color: #e0e7ff; }
        .tag-freq-3 { font-size: 1.3rem; background-color: #c7d2fe; }
        .tag-freq-4 { font-size: 1.5rem; background-color: #a5b4fc; color: white; }
        .tag-freq-5 { font-size: 1.7rem; background-color: #8b5cf6; color: white; }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .control-group {
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            padding: 8px 16px;
            background-color: #f1f5f9;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .control-btn.active {
            background-color: #8b5cf6;
            color: white;
        }
        
        .control-btn:hover:not(.active) {
            background-color: #e2e8f0;
        }
        
        .data-source {
            font-size: 0.9rem;
            color: #94a3b8;
            text-align: right;
            margin-top: 10px;
            font-style: italic;
        }
        
        .section-description {
            color: #64748b;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #64748b;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
            margin-top: 30px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1400px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 900px) {
            .container {
                padding: 10px;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            .chart-wrapper {
                height: 400px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .chart-title {
                font-size: 1.3rem;
            }
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 6px;
        }
        
        .matrix-cell {
            cursor: pointer;
        }
        
        .matrix-cell:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ç”µå•†è¥é”€å²—ä½æ ‡ç­¾å¯è§†åŒ–ç³»ç»Ÿ</h1>
            <p class="subtitle">åŸºäºç”µå•†è¥é”€å²—ä½èŒä½æ ‡ç­¾çš„è¯é¢‘ç»Ÿè®¡ã€å…±ç°ç½‘ç»œåˆ†æå’Œå…³è”çŸ©é˜µå¯è§†åŒ–åˆ†æ</p>
        </header>
        
        <div class="data-summary">
            <div class="summary-card">
                <div class="summary-value">137</div>
                <div class="summary-label">æœ€é«˜é¢‘æ ‡ç­¾å‡ºç°æ¬¡æ•°</div>
                <div class="summary-label">"çŸ­è§†é¢‘"æ ‡ç­¾åœ¨å²—ä½ä¸­å‡ºç°137æ¬¡</div>
            </div>
            
            <div class="summary-card">
                <div class="summary-value">20</div>
                <div class="summary-label">é«˜é¢‘æ ‡ç­¾æ•°é‡</div>
                <div class="summary-label">ç»Ÿè®¡å‡ºç°é¢‘ç‡æœ€é«˜çš„20ä¸ªå²—ä½æ ‡ç­¾</div>
            </div>
            
            <div class="summary-card">
                <div class="summary-value">85</div>
                <div class="summary-label">æœ€å¼ºæ ‡ç­¾å…³è”</div>
                <div class="summary-label">"çŸ­è§†é¢‘"ä¸"ç›´æ’­"å…±ç°85æ¬¡</div>
            </div>
            
            <div class="summary-card">
                <div class="summary-value">63</div>
                <div class="summary-label">æ€»æ ‡ç­¾æ•°é‡</div>
                <div class="summary-label">ç»è¿‡åˆ†è¯å’ŒåŒä¹‰åˆå¹¶åçš„æ ‡ç­¾æ€»æ•°</div>
            </div>
        </div>
        
        <div class="dashboard">
            <!-- è¯é¢‘ç»Ÿè®¡å›¾è¡¨ -->
            <div class="chart-container">
                <div class="chart-title">
                    <i>ğŸ“Š</i> èŒä½æ ‡ç­¾è¯é¢‘ç»Ÿè®¡ï¼ˆTOP20ï¼‰
                </div>
                <p class="section-description">å±•ç¤ºç”µå•†è¥é”€å²—ä½ä¸­æœ€å¸¸å‡ºç°çš„20ä¸ªæŠ€èƒ½æ ‡ç­¾åŠå…¶å‡ºç°é¢‘ç‡ï¼Œåæ˜ å½“å‰å¸‚åœºå¯¹ç”µå•†äººæ‰çš„æ ¸å¿ƒèƒ½åŠ›è¦æ±‚ã€‚</p>
                <div class="controls">
                    <div class="control-group">
                        <button class="control-btn active" data-chart="wordcloud" data-type="wordcloud">è¯äº‘å›¾</button>
                        <button class="control-btn" data-chart="wordcloud" data-type="bar">æ¡å½¢å›¾</button>
                        <button class="control-btn" data-chart="wordcloud" data-type="treemap">çŸ©å½¢æ ‘å›¾</button>
                    </div>
                    <div class="data-source">æ•°æ®æ¥æºï¼šæ¨¡æ‹Ÿç”µå•†å²—ä½æ•°æ®ï¼ŒåŸºäº63ä¸ªæ ‡ç­¾æ± </div>
                </div>
                <div id="wordcloud-chart" class="chart-wrapper"></div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #8b5cf6;"></div>
                        <span>å‡ºç°é¢‘ç‡ > 100</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #a5b4fc;"></div>
                        <span>å‡ºç°é¢‘ç‡ 80-100</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #c7d2fe;"></div>
                        <span>å‡ºç°é¢‘ç‡ 60-80</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #e0e7ff;"></div>
                        <span>å‡ºç°é¢‘ç‡ < 60</span>
                    </div>
                </div>
            </div>
            
            <!-- æ ‡ç­¾å…±ç°ç½‘ç»œå›¾ -->
            <div class="chart-container">
                <div class="chart-title">
                    <i>ğŸ•¸ï¸</i> æ ‡ç­¾å…±ç°ç½‘ç»œå›¾
                </div>
                <p class="section-description">å±•ç¤ºé«˜é¢‘æ ‡ç­¾ä¹‹é—´çš„å…±ç°å…³ç³»ï¼ŒèŠ‚ç‚¹å¤§å°è¡¨ç¤ºæ ‡ç­¾å‡ºç°é¢‘ç‡ï¼Œè¿çº¿ç²—ç»†è¡¨ç¤ºæ ‡ç­¾å…±ç°å¼ºåº¦ï¼Œå¸®åŠ©è¯†åˆ«æŠ€èƒ½ç»„åˆæ¨¡å¼ã€‚</p>
                <div class="controls">
                    <div class="control-group">
                        <button class="control-btn active" data-chart="network" data-type="force">åŠ›å¯¼å‘å›¾</button>
                        <button class="control-btn" data-chart="network" data-type="circular">ç¯å½¢å¸ƒå±€</button>
                        <button class="control-btn" data-chart="network" data-type="matrix">çŸ©é˜µå¸ƒå±€</button>
                    </div>
                    <div class="data-source">æ•°æ®æ¥æºï¼šæ¨¡æ‹Ÿç”µå•†å²—ä½æ•°æ®ï¼Œå…±ç°å…³ç³»åŸºäºå²—ä½-æ ‡ç­¾å…³è”è¡¨</div>
                </div>
                <div id="network-chart" class="chart-wrapper"></div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #8b5cf6;"></div>
                        <span>æ ¸å¿ƒæŠ€èƒ½æ ‡ç­¾ï¼ˆé«˜é¢‘ï¼‰</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #10b981;"></div>
                        <span>è¿è¥æŠ€èƒ½æ ‡ç­¾</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #f59e0b;"></div>
                        <span>å†…å®¹åˆ›ä½œæ ‡ç­¾</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ef4444;"></div>
                        <span>æ•°æ®åˆ†ææ ‡ç­¾</span>
                    </div>
                </div>
            </div>
            
            <!-- æ ‡ç­¾å…³è”çŸ©é˜µå›¾ -->
            <div class="chart-container">
                <div class="chart-title">
                    <i>ğŸ”²</i> å²—ä½-æ ‡ç­¾å…³è”çŸ©é˜µ
                </div>
                <p class="section-description">å±•ç¤ºæ ‡ç­¾ä¹‹é—´çš„å…±ç°å¼ºåº¦çŸ©é˜µï¼Œé¢œè‰²æ·±æµ…è¡¨ç¤ºä¸¤ä¸ªæ ‡ç­¾åœ¨å²—ä½æè¿°ä¸­åŒæ—¶å‡ºç°çš„é¢‘ç‡ï¼Œå¯ç”¨äºè¯†åˆ«å¼ºå…³è”çš„æŠ€èƒ½ç»„åˆã€‚</p>
                <div class="controls">
                    <div class="control-group">
                        <button class="control-btn active" data-chart="matrix" data-type="heatmap">çƒ­åŠ›å›¾</button>
                        <button class="control-btn" data-chart="matrix" data-type="correlation">ç›¸å…³æ€§çŸ©é˜µ</button>
                    </div>
                    <div class="data-source">æ•°æ®æ¥æºï¼šæ¨¡æ‹Ÿç”µå•†å²—ä½æ•°æ®ï¼Œæ–¹å½¢CSVå…±ç°çŸ©é˜µ</div>
                </div>
                <div id="matrix-chart" class="chart-wrapper"></div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #1e3a8a;"></div>
                        <span>å¼ºå…³è”ï¼ˆå…±ç° > 70ï¼‰</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #3b82f6;"></div>
                        <span>ä¸­ç­‰å…³è”ï¼ˆå…±ç° 40-70ï¼‰</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #93c5fd;"></div>
                        <span>å¼±å…³è”ï¼ˆå…±ç° 20-40ï¼‰</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #dbeafe;"></div>
                        <span>æ— å…³è”/è‡ªå…³è”ï¼ˆå…±ç° < 20ï¼‰</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">
                <i>ğŸ·ï¸</i> é«˜é¢‘æ ‡ç­¾æ± é¢„è§ˆ
            </div>
            <p class="section-description">å®Œæ•´çš„ç”µå•†è¥é”€å²—ä½æ ‡ç­¾æ± ï¼ˆå·²åˆ†è¯+åŒä¹‰åˆå¹¶ï¼‰ï¼Œå…±63ä¸ªæ ‡ç­¾ï¼ŒæŒ‰å‡ºç°é¢‘ç‡ä»é«˜åˆ°ä½æ’åˆ—ï¼š</p>
            <div class="tag-cloud-container" id="tag-cloud-preview"></div>
        </div>
        
        <footer>
            <p>ç”µå•†è¥é”€å²—ä½æ ‡ç­¾å¯è§†åŒ–ç³»ç»Ÿ &copy; 2023 | åŸºäºEChartså®ç° | æ•°æ®ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼ŒåŸºäºå¸¸è§ç”µå•†å²—ä½è¦æ±‚ç”Ÿæˆ</p>
        </footer>
    </div>

    <script>
        // åˆå§‹åŒ–æ•°æ®
        const tagData = {
            // é«˜é¢‘TOP20æ ‡ç­¾åŠé¢‘ç‡
            top20Tags: [
                { name: 'çŸ­è§†é¢‘', value: 137 },
                { name: 'ç›´æ’­', value: 129 },
                { name: 'æŠ–éŸ³', value: 119 },
                { name: 'å°çº¢ä¹¦', value: 108 },
                { name: 'ç§åŸŸ', value: 95 },
                { name: 'å†…å®¹ç­–åˆ’', value: 93 },
                { name: 'æ•°æ®åˆ†æ', value: 91 },
                { name: 'KOL', value: 89 },
                { name: 'ROI', value: 86 },
                { name: 'æ•´åˆè¥é”€', value: 82 },
                { name: 'çˆ†æ¬¾', value: 80 },
                { name: 'æŠ•æµ', value: 78 },
                { name: 'ç¤¾ç¾¤', value: 76 },
                { name: 'è½¬åŒ–ç‡', value: 74 },
                { name: '618/åŒ11', value: 72 },
                { name: 'TikTok', value: 70 },
                { name: 'è·¨å¢ƒç”µå•†', value: 68 },
                { name: 'å“ç‰Œ', value: 66 },
                { name: 'è„šæœ¬', value: 64 },
                { name: 'åˆ›æ„', value: 62 }
            ],
            
            // å®Œæ•´æ ‡ç­¾æ± 
            allTags: [
                'çŸ­è§†é¢‘', 'ç›´æ’­', 'æŠ–éŸ³', 'å°çº¢ä¹¦', 'ç§åŸŸ', 'ç¤¾ç¾¤', 'å†…å®¹ç­–åˆ’', 'æ•°æ®åˆ†æ', 'KOL', 'KOC', 
                'æŠ•æµ', 'ROI', 'å“ç‰Œ', 'çˆ†æ¬¾', 'çˆ†æ¬¾æ‰“é€ ', 'æ•´åˆè¥é”€', '618/åŒ11', 'è·¨å¢ƒç”µå•†', 'TikTok', 'AIå·¥å…·', 
                'ç”¨æˆ·æ´å¯Ÿ', 'è„šæœ¬', 'å›¾æ–‡', 'æŠ•åå¤ç›˜', 'æµé‡è·å–', 'GMV', 'è½¬åŒ–ç‡', 'å®¢å•ä»·', 'å¤è´­ç‡', 'è¾¾äººåˆä½œ', 
                'åª’ä»‹æŠ•æ”¾', 'åˆ›æ„', 'æ–‡æ¡ˆ', 'è§†è§‰', 'é¡µé¢ç­–åˆ’', 'SEO/SEM', 'ç›´é€šè½¦', 'åƒå·', 'ä¸‡ç›¸å°', 'æ¨å¹¿å·¥å…·', 
                'Excel', 'Python', 'BI', 'SQL', 'è‹±è¯­', 'æ³°è¯­', 'æ—¥è¯­', 'æ²Ÿé€šèƒ½åŠ›', 'æŠ—å‹', 'è‡ªé©±', 
                'å›¢é˜Ÿåä½œ', 'é¡¹ç›®ç®¡ç†', 'è·¨éƒ¨é—¨', '0-1', 'ä»0åˆ°1', 'å¸¦å›¢é˜Ÿ', 'åˆ›ä¸š', 'åˆä¼™äºº', 'äº”é™©ä¸€é‡‘', 'åŒä¼‘', 
                'è¿œç¨‹', 'å®ä¹ ', 'åº”å±Šç”Ÿ', 'æ¥å—å°ç™½'
            ],
            
            // æ ‡ç­¾åˆ†ç±»
            tagCategories: {
                'æ ¸å¿ƒæŠ€èƒ½': ['çŸ­è§†é¢‘', 'ç›´æ’­', 'æŠ–éŸ³', 'å°çº¢ä¹¦', 'ç§åŸŸ', 'ç¤¾ç¾¤', 'TikTok'],
                'è¿è¥æŠ€èƒ½': ['æŠ•æµ', 'ROI', 'çˆ†æ¬¾', 'æ•´åˆè¥é”€', 'è·¨å¢ƒç”µå•†', '618/åŒ11', 'è½¬åŒ–ç‡', 'GMV', 'å®¢å•ä»·', 'å¤è´­ç‡'],
                'å†…å®¹åˆ›ä½œ': ['å†…å®¹ç­–åˆ’', 'è„šæœ¬', 'å›¾æ–‡', 'åˆ›æ„', 'æ–‡æ¡ˆ', 'è§†è§‰', 'é¡µé¢ç­–åˆ’'],
                'æ•°æ®åˆ†æ': ['æ•°æ®åˆ†æ', 'æŠ•åå¤ç›˜', 'ç”¨æˆ·æ´å¯Ÿ', 'Excel', 'Python', 'BI', 'SQL'],
                'è½¯æŠ€èƒ½': ['æ²Ÿé€šèƒ½åŠ›', 'æŠ—å‹', 'è‡ªé©±', 'å›¢é˜Ÿåä½œ', 'é¡¹ç›®ç®¡ç†', 'è·¨éƒ¨é—¨', 'è‹±è¯­', 'æ³°è¯­', 'æ—¥è¯­']
            },
            
            // ç”Ÿæˆæ ‡ç­¾å…±ç°çŸ©é˜µï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰
            generateCooccurrenceMatrix: function() {
                const tags = this.top20Tags.map(tag => tag.name);
                const matrix = [];
                
                // åˆå§‹åŒ–20x20çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸º0
                for (let i = 0; i < tags.length; i++) {
                    matrix[i] = new Array(tags.length).fill(0);
                }
                
                // ç”Ÿæˆæ¨¡æ‹Ÿçš„å…±ç°æ•°æ®
                // æ ¸å¿ƒå‡è®¾ï¼šç›¸å…³æ ‡ç­¾ä¹‹é—´å…±ç°é¢‘ç‡æ›´é«˜
                for (let i = 0; i < tags.length; i++) {
                    for (let j = i + 1; j < tags.length; j++) {
                        // åŸºç¡€å…±ç°å€¼ï¼ŒåŸºäºä¸¤ä¸ªæ ‡ç­¾çš„é¢‘ç‡
                        const baseValue = Math.min(
                            this.top20Tags[i].value / 2, 
                            this.top20Tags[j].value / 2
                        ) * 0.5;
                        
                        // æ·»åŠ éšæœºæ³¢åŠ¨
                        const randomFactor = 0.7 + Math.random() * 0.6;
                        
                        // ç›¸å…³æ ‡ç­¾ç»„ä¹‹é—´å…±ç°é¢‘ç‡æ›´é«˜
                        let groupFactor = 1.0;
                        const tag1 = tags[i];
                        const tag2 = tags[j];
                        
                        // æ£€æŸ¥æ˜¯å¦å±äºåŒä¸€æ ‡ç­¾ç»„
                        for (const category in this.tagCategories) {
                            const categoryTags = this.tagCategories[category];
                            if (categoryTags.includes(tag1) && categoryTags.includes(tag2)) {
                                groupFactor = 1.8; // åŒä¸€ç»„å†…çš„æ ‡ç­¾å…±ç°é¢‘ç‡æ›´é«˜
                                break;
                            }
                        }
                        
                        // ç‰¹åˆ«å¼ºçš„å…³è”
                        if (
                            (tag1 === 'çŸ­è§†é¢‘' && tag2 === 'ç›´æ’­') ||
                            (tag1 === 'ç›´æ’­' && tag2 === 'çŸ­è§†é¢‘') ||
                            (tag1 === 'æŠ–éŸ³' && tag2 === 'çŸ­è§†é¢‘') ||
                            (tag1 === 'çŸ­è§†é¢‘' && tag2 === 'æŠ–éŸ³') ||
                            (tag1 === 'å°çº¢ä¹¦' && tag2 === 'å†…å®¹ç­–åˆ’') ||
                            (tag1 === 'å†…å®¹ç­–åˆ’' && tag2 === 'å°çº¢ä¹¦') ||
                            (tag1 === 'æ•°æ®åˆ†æ' && tag2 === 'ROI') ||
                            (tag1 === 'ROI' && tag2 === 'æ•°æ®åˆ†æ')
                        ) {
                            groupFactor = 2.2;
                        }
                        
                        const cooccurrence = Math.round(baseValue * randomFactor * groupFactor);
                        matrix[i][j] = cooccurrence;
                        matrix[j][i] = cooccurrence; // å¯¹ç§°çŸ©é˜µ
                    }
                }
                
                return {
                    tags: tags,
                    matrix: matrix
                };
            },
            
            // ç”Ÿæˆç½‘ç»œå›¾æ•°æ®
            generateNetworkData: function() {
                const tags = this.top20Tags.map(tag => tag.name);
                const matrixData = this.generateCooccurrenceMatrix();
                const matrix = matrixData.matrix;
                
                // èŠ‚ç‚¹æ•°æ®
                const nodes = [];
                for (let i = 0; i < tags.length; i++) {
                    const tag = tags[i];
                    const value = this.top20Tags[i].value;
                    
                    // ç¡®å®šèŠ‚ç‚¹ç±»åˆ«
                    let category = 'å…¶ä»–';
                    for (const cat in this.tagCategories) {
                        if (this.tagCategories[cat].includes(tag)) {
                            category = cat;
                            break;
                        }
                    }
                    
                    // ç¡®å®šèŠ‚ç‚¹å¤§å°
                    const symbolSize = 10 + (value / 137) * 30; // æ ¹æ®é¢‘ç‡è°ƒæ•´å¤§å°
                    
                    nodes.push({
                        name: tag,
                        value: value,
                        symbolSize: symbolSize,
                        category: category,
                        itemStyle: {
                            color: this.getCategoryColor(category)
                        }
                    });
                }
                
                // è¾¹æ•°æ®
                const edges = [];
                for (let i = 0; i < tags.length; i++) {
                    for (let j = i + 1; j < tags.length; j++) {
                        const cooccurrence = matrix[i][j];
                        // åªæ·»åŠ è¾ƒå¼ºçš„å…³è”
                        if (cooccurrence > 30) {
                            edges.push({
                                source: tags[i],
                                target: tags[j],
                                value: cooccurrence,
                                lineStyle: {
                                    width: cooccurrence / 20, // æ ¹æ®å…±ç°å¼ºåº¦è°ƒæ•´çº¿å®½
                                    color: this.getEdgeColor(cooccurrence)
                                }
                            });
                        }
                    }
                }
                
                return { nodes: nodes, edges: edges };
            },
            
            // è·å–ç±»åˆ«é¢œè‰²
            getCategoryColor: function(category) {
                const colorMap = {
                    'æ ¸å¿ƒæŠ€èƒ½': '#8b5cf6',
                    'è¿è¥æŠ€èƒ½': '#10b981',
                    'å†…å®¹åˆ›ä½œ': '#f59e0b',
                    'æ•°æ®åˆ†æ': '#ef4444',
                    'è½¯æŠ€èƒ½': '#8b5cf6',
                    'å…¶ä»–': '#94a3b8'
                };
                return colorMap[category] || '#94a3b8';
            },
            
            // è·å–è¾¹é¢œè‰²
            getEdgeColor: function(value) {
                if (value > 70) return 'rgba(139, 92, 246, 0.8)';
                if (value > 50) return 'rgba(139, 92, 246, 0.6)';
                if (value > 30) return 'rgba(139, 92, 246, 0.4)';
                return 'rgba(139, 92, 246, 0.2)';
            }
        };
        
        // å›¾è¡¨å®ä¾‹å­˜å‚¨
        const chartInstances = {};
        
        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        function initCharts() {
            // åˆå§‹åŒ–è¯é¢‘å›¾è¡¨
            initWordCloudChart('wordcloud');
            
            // åˆå§‹åŒ–ç½‘ç»œå›¾
            initNetworkChart('force');
            
            // åˆå§‹åŒ–çŸ©é˜µå›¾
            initMatrixChart('heatmap');
            
            // åˆå§‹åŒ–æ ‡ç­¾äº‘é¢„è§ˆ
            initTagCloudPreview();
            
            // ç»‘å®šå›¾è¡¨åˆ‡æ¢æŒ‰é’®äº‹ä»¶
            bindChartControlButtons();
        }
        
        // åˆå§‹åŒ–è¯é¢‘å›¾è¡¨
        function initWordCloudChart(type) {
            const chartDom = document.getElementById('wordcloud-chart');
            chartInstances.wordcloud = echarts.init(chartDom);
            
            let option;
            if (type === 'wordcloud') {
                option = {
                    tooltip: {
                        formatter: function(params) {
                            return `${params.name}<br/>å‡ºç°é¢‘ç‡: ${params.value}æ¬¡`;
                        }
                    },
                    series: [{
                        type: 'wordCloud',
                        shape: 'circle',
                        left: 'center',
                        top: 'center',
                        width: '90%',
                        height: '90%',
                        right: null,
                        bottom: null,
                        sizeRange: [20, 60],
                        rotationRange: [0, 0],
                        rotationStep: 45,
                        gridSize: 8,
                        drawOutOfBound: false,
                        textStyle: {
                            fontFamily: 'sans-serif',
                            fontWeight: 'bold',
                            color: function(params) {
                                const value = params.value;
                                if (value > 100) return '#8b5cf6';
                                if (value > 80) return '#a5b4fc';
                                if (value > 60) return '#c7d2fe';
                                return '#e0e7ff';
                            }
                        },
                        emphasis: {
                            focus: 'self',
                            textStyle: {
                                shadowBlur: 10,
                                shadowColor: '#333'
                            }
                        },
                        data: tagData.top20Tags
                    }],
                    title: {
                        text: 'ç”µå•†è¥é”€å²—ä½é«˜é¢‘æ ‡ç­¾è¯äº‘',
                        left: 'center',
                        top: 10,
                        textStyle: {
                            fontSize: 16,
                            fontWeight: 'normal',
                            color: '#2c3e50'
                        }
                    }
                };
            } else if (type === 'bar') {
                // æ¡å½¢å›¾
                const sortedTags = [...tagData.top20Tags].sort((a, b) => a.value - b.value);
                
                option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: { type: 'shadow' }
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        top: '10%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        name: 'å‡ºç°é¢‘ç‡',
                        axisLabel: {
                            color: '#666'
                        }
                    },
                    yAxis: {
                        type: 'category',
                        data: sortedTags.map(tag => tag.name),
                        axisLabel: {
                            color: '#666'
                        }
                    },
                    series: [{
                        data: sortedTags.map(tag => tag.value),
                        type: 'bar',
                        itemStyle: {
                            color: function(params) {
                                const value = sortedTags[params.dataIndex].value;
                                if (value > 100) return '#8b5cf6';
                                if (value > 80) return '#a5b4fc';
                                if (value > 60) return '#c7d2fe';
                                return '#e0e7ff';
                            }
                        },
                        label: {
                            show: true,
                            position: 'right',
                            color: '#333'
                        }
                    }],
                    title: {
                        text: 'ç”µå•†è¥é”€å²—ä½é«˜é¢‘æ ‡ç­¾æ¡å½¢å›¾',
                        left: 'center',
                        top: 10,
                        textStyle: {
                            fontSize: 16,
                            fontWeight: 'normal',
                            color: '#2c3e50'
                        }
                    }
                };
            } else {
                // çŸ©å½¢æ ‘å›¾
                option = {
                    tooltip: {
                        formatter: function(params) {
                            return `${params.data.name}<br/>å‡ºç°é¢‘ç‡: ${params.data.value}æ¬¡`;
                        }
                    },
                    series: [{
                        type: 'treemap',
                        data: tagData.top20Tags,
                        leafDepth: 1,
                        label: {
                            show: true,
                            formatter: '{b}'
                        },
                        upperLabel: {
                            show: true,
                            height: 30
                        },
                        itemStyle: {
                            borderColor: '#fff'
                        },
                        levels: [
                            {
                                itemStyle: {
                                    borderWidth: 0,
                                    gapWidth: 5
                                }
                            },
                            {
                                colorSaturation: [0.3, 0.6],
                                itemStyle: {
                                    borderWidth: 5,
                                    gapWidth: 1,
                                    borderColorSaturation: 0.7
                                }
                            }
                        ]
                    }],
                    title: {
                        text: 'ç”µå•†è¥é”€å²—ä½é«˜é¢‘æ ‡ç­¾çŸ©å½¢æ ‘å›¾',
                        left: 'center',
                        top: 10,
                        textStyle: {
                            fontSize: 16,
                            fontWeight: 'normal',
                            color: '#2c3e50'
                        }
                    }
                };
            }
            
            chartInstances.wordcloud.setOption(option);
        }
        
        // åˆå§‹åŒ–ç½‘ç»œå›¾
        function initNetworkChart(layoutType) {
            const chartDom = document.getElementById('network-chart');
            chartInstances.network = echarts.init(chartDom);
            
            const networkData = tagData.generateNetworkData();
            
            let option = {
                tooltip: {
                    formatter: function(params) {
                        if (params.dataType === 'node') {
                            return `${params.data.name}<br/>å‡ºç°é¢‘ç‡: ${params.data.value}æ¬¡`;
                        } else if (params.dataType === 'edge') {
                            return `${params.data.source} â†” ${params.data.target}<br/>å…±ç°é¢‘ç‡: ${params.data.value}æ¬¡`;
                        }
                    }
                },
                legend: {
                    data: Object.keys(tagData.tagCategories),
                    top: 40, // è°ƒæ•´å›¾ä¾‹ä½ç½®ï¼Œé¿å…ä¸æ ‡é¢˜é‡å 
                    left: 'center',
                    textStyle: {
                        fontSize: 12
                    }
                },
                series: [{
                    type: 'graph',
                    layout: layoutType,
                    data: networkData.nodes,
                    links: networkData.edges,
                    categories: Object.keys(tagData.tagCategories).map(category => ({ name: category })),
                    roam: true,
                    label: {
                        show: true,
                        position: 'right',
                        formatter: '{b}',
                        fontSize: 12
                    },
                    lineStyle: {
                        color: 'source',
                        curveness: 0.2
                    },
                    emphasis: {
                        focus: 'adjacency',
                        lineStyle: {
                            width: 4
                        }
                    },
                    edgeSymbol: ['none', 'arrow'],
                    edgeSymbolSize: [4, 10],
                    edgeLabel: {
                        show: false
                    },
                    // åŠ›å¯¼å‘å›¾å¸ƒå±€å‚æ•°è°ƒæ•´
                    force: {
                        // å¢åŠ èŠ‚ç‚¹é—´çš„æ–¥åŠ›ï¼Œä½¿èŠ‚ç‚¹è·ç¦»æ›´è¿œ
                        repulsion: 1000,
                        // å¢åŠ è¾¹çš„å¼•åŠ›ï¼Œä½¿å…³è”çš„èŠ‚ç‚¹æ›´æ¥è¿‘
                        gravity: 0.1,
                        // å¢åŠ å¸ƒå±€çš„è¿­ä»£æ¬¡æ•°
                        layoutAnimation: true
                    },
                    // ç¯å½¢å¸ƒå±€å‚æ•°
                    circular: {
                        rotateLabel: true
                    }
                }],
                title: {
                    text: 'ç”µå•†è¥é”€å²—ä½æ ‡ç­¾å…±ç°ç½‘ç»œå›¾',
                    left: 'center',
                    top: 10, // è°ƒæ•´æ ‡é¢˜ä½ç½®
                    textStyle: {
                        fontSize: 16,
                        fontWeight: 'normal',
                        color: '#2c3e50'
                    }
                },
                // å¢åŠ å›¾å½¢åŒºåŸŸçš„å†…è¾¹è·ï¼Œä¸ºå›¾ä¾‹ç•™å‡ºç©ºé—´
                grid: {
                    top: 80,
                    bottom: 20,
                    left: 20,
                    right: 20,
                    containLabel: true
                }
            };
            
            chartInstances.network.setOption(option);
        }
        
        // åˆå§‹åŒ–çŸ©é˜µå›¾
        function initMatrixChart(type) {
            const chartDom = document.getElementById('matrix-chart');
            chartInstances.matrix = echarts.init(chartDom);
            
            const matrixData = tagData.generateCooccurrenceMatrix();
            const tags = matrixData.tags;
            const matrix = matrixData.matrix;
            
            // å‡†å¤‡çƒ­åŠ›å›¾æ•°æ®
            const heatmapData = [];
            for (let i = 0; i < tags.length; i++) {
                for (let j = 0; j < tags.length; j++) {
                    heatmapData.push([j, i, matrix[i][j] || '-']);
                }
            }
            
            let option = {
                tooltip: {
                    position: 'top',
                    formatter: function(params) {
                        const xIndex = params.value[0];
                        const yIndex = params.value[1];
                        const value = params.value[2];
                        return `${tags[yIndex]} â†” ${tags[xIndex]}<br/>å…±ç°æ¬¡æ•°: ${value}`;
                    }
                },
                grid: {
                    height: '80%',
                    top: '10%',
                    left: '15%',
                    right: '10%'
                },
                xAxis: {
                    type: 'category',
                    data: tags,
                    splitArea: {
                        show: true
                    },
                    axisLabel: {
                        rotate: 45,
                        fontSize: 10
                    }
                },
                yAxis: {
                    type: 'category',
                    data: tags,
                    splitArea: {
                        show: true
                    },
                    axisLabel: {
                        fontSize: 10
                    }
                },
                visualMap: {
                    min: 0,
                    max: 100,
                    calculable: true,
                    orient: 'vertical',
                    left: 'right',
                    top: 'center',
                    inRange: {
                        color: ['#dbeafe', '#93c5fd', '#3b82f6', '#1e3a8a']
                    },
                    textStyle: {
                        color: '#333'
                    }
                },
                series: [{
                    name: 'å…±ç°æ¬¡æ•°',
                    type: 'heatmap',
                    data: heatmapData,
                    label: {
                        show: false
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }],
                title: {
                    text: 'ç”µå•†è¥é”€å²—ä½æ ‡ç­¾å…±ç°çŸ©é˜µ',
                    left: 'center',
                    top: 10,
                    textStyle: {
                        fontSize: 16,
                        fontWeight: 'normal',
                        color: '#2c3e50'
                    }
                }
            };
            
            chartInstances.matrix.setOption(option);
        }
        
        // åˆå§‹åŒ–æ ‡ç­¾äº‘é¢„è§ˆ
        function initTagCloudPreview() {
            const container = document.getElementById('tag-cloud-preview');
            container.innerHTML = '';
            
            // æŒ‰é¢‘ç‡æ’åº
            const sortedTags = tagData.top20Tags
                .concat(tagData.allTags
                    .filter(tag => !tagData.top20Tags.some(t => t.name === tag))
                    .map(tag => ({ name: tag, value: Math.floor(Math.random() * 60) }))
                )
                .sort((a, b) => b.value - a.value);
            
            sortedTags.forEach(tag => {
                const div = document.createElement('div');
                div.className = 'tag-item';
                
                // æ ¹æ®é¢‘ç‡è®¾ç½®ä¸åŒçš„æ ·å¼
                let freqClass = 'tag-freq-1';
                if (tag.value > 100) freqClass = 'tag-freq-5';
                else if (tag.value > 80) freqClass = 'tag-freq-4';
                else if (tag.value > 60) freqClass = 'tag-freq-3';
                else if (tag.value > 40) freqClass = 'tag-freq-2';
                
                div.classList.add(freqClass);
                div.textContent = tag.name;
                div.title = `${tag.name}: å‡ºç°${tag.value}æ¬¡`;
                
                container.appendChild(div);
            });
        }
        
        // ç»‘å®šå›¾è¡¨æ§åˆ¶æŒ‰é’®äº‹ä»¶
        function bindChartControlButtons() {
            document.querySelectorAll('.control-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const chart = this.getAttribute('data-chart');
                    const type = this.getAttribute('data-type');
                    
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    this.parentElement.querySelectorAll('.control-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // é‡æ–°åˆå§‹åŒ–å¯¹åº”å›¾è¡¨
                    switch(chart) {
                        case 'wordcloud':
                            initWordCloudChart(type);
                            break;
                        case 'network':
                            initNetworkChart(type);
                            break;
                        case 'matrix':
                            initMatrixChart(type);
                            break;
                    }
                });
            });
        }
        
        // çª—å£å¤§å°æ”¹å˜æ—¶é‡ç½®å›¾è¡¨å¤§å°
        window.addEventListener('resize', function() {
            Object.values(chartInstances).forEach(chart => {
                if (chart && chart.resize) {
                    chart.resize();
                }
            });
        });
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initCharts);
    </script>
</body>
</html>
